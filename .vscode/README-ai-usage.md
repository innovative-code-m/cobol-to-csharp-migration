# AI運用ルール（VS Code用）

本ドキュメントは、本プロジェクトにおいて **VS Code を使用し、複数の AI（ChatGPT / Codex / Gemini / Claude）を安全かつ再現性高く運用するためのルール** を定義する。

本ルールの目的は以下の3点である。

- AIの役割混在による品質低下・設計崩壊を防ぐ
- 誰が作業しても同じ判断・同じ手順でAIを使えるようにする
- 会話ログではなく、リポジトリに成果と判断を残す

---

## 1. 基本方針（最重要）

### 1.1 AIは「切り替えて使う」

- 複数AIを**同時に混在させない**
- 1タスク = 1AI = 1役割 を原則とする
- 役割を変える場合は **AI（拡張）を切り替える**

### 1.2 設計・仕様はAIに決めさせない

- 設計・仕様の最終決定権は **人間 + ChatGPT（編集長）** が持つ
- Codex / Claude / Gemini は決定済み仕様の範囲でのみ作業する

### 1.3 正はリポジトリに置く

- 正式な仕様・判断・成果物はすべて Git 管理する
- チャット履歴は記録としない（参考情報扱い）

---

## 2. 使用AIと役割定義（固定）

| AI | VS Code上の実体 | 役割 | 主な用途 |
|---|---|---|---|
| ChatGPT | GitHub Copilot Chat | 編集長 / 司令塔 | 仕様化、設計統合、README/仕様書更新 |
| Codex | GitHub Copilot Chat | 実装担当 | コード生成、関数実装、テスト実装 |
| Gemini | Gemini Code Assist | 監査担当 | 仕様監査、抜け漏れ、テスト観点 |
| Claude | Claude Code | 探索・改修担当 | 複数ファイル改修、構造整理 |

※ **モデル名（GPT-4 / Claude 3.x 等）は指定しない**。役割のみ指定する。

---

## 3. VS CodeでのAI切り替えルール

### 3.1 切り替え方法

VS Codeでは以下をもって AI を切り替える。

- Copilot Chat パネルを開く → ChatGPT / Codex
- Claude Code パネルを開く → Claude
- Gemini Code Assist パネルを開く → Gemini

**同一チャット内で役割を切り替えないこと。**

---

## 4. ファイル別・AI割当ルール

| 対象 | 使用AI | 補足 |
|---|---|---|
| `docs/spec/*.md` | ChatGPT | 仕様・設計の正本 |
| `docs/decisions/*.md` | ChatGPT | 判断記録（ADR） |
| `src/**` 実装 | Codex | 差分で生成させる |
| `tests/**` | Codex → Gemini | 実装後に必ず監査 |
| 複数ファイル横断 | Claude | 構造変更のみ担当 |

---

## 5. プロンプト運用ルール

### 5.1 必須記載事項（全AI共通）

以下を **必ず明示** すること。

- あなたの役割（実装 / 監査 / 改修 など）
- 目的
- 対象ファイル
- 受入基準
- 禁止事項（やってはいけないこと）

### 5.2 実装用（Codex）指示例

```
あなたは実装担当です。
目的は、既存仕様を満たすコードを実装することです。
設計変更・仕様提案は禁止します。
出力は差分（patch）で返してください。
```

### 5.3 監査用（Gemini）指示例

```
あなたは監査担当です。
実装は変更せず、以下を指摘してください。
- 仕様との齟齬
- 未実装・抜け漏れ
- テスト不足
```

### 5.4 改修用（Claude）指示例

```
あなたは構造改修担当です。
複数ファイルを横断して整理してください。
機能仕様は変更しないでください。
```

---

## 6. 標準ワークフロー

### 6.1 実装フロー（基本）

1. ChatGPT で仕様を `docs/spec` に確定
2. Codex で実装（差分）
3. ローカルでビルド・テスト
4. Gemini で監査
5. 必要に応じて Claude で構造整理
6. ChatGPT で README / 仕様 / ADR 更新

---

## 7. 禁止事項（重要）

- 同一チャットで「実装 → 監査 → 設計変更」を行うこと
- AIにアーキテクチャ判断を委ねること
- 会話ログだけで作業を完了させること
- モデル名を前提とした運用

---

## 8. 例外対応

- 本ルールから外れる運用が必要な場合は
  - `docs/decisions/` に ADR を作成する
  - 理由と影響範囲を明記する

---

## 9. 本ドキュメントの更新

- AI運用ルールに変更があった場合は
  - 本ファイルを更新
  - 変更理由を ADR として残す

---

以上

