# ADR-0001: AI連携開発におけるツール選定（VS Code / プロンプト駆動）

## Status
Accepted

---

## Context（背景・課題）

本プロジェクトでは、ChatGPT / Codex / Gemini / Claude といった複数の AI を併用し、
仕様策定・実装・テスト・監査・構造改修までを一貫して AI 支援で進めることを目的としている。

しかし、複数 AI を同時に使用する場合、以下の問題が発生しやすい。

- AI ごとに得意分野・振る舞いが異なり、判断が一貫しない
- 誰が・どの AI で・何を決めたのかが不明瞭になる
- 会話ログに判断が埋もれ、後から再現できない
- AI が勝手に設計・構造を変更し、品質事故につながる

これらを防ぐため、**開発ツールと AI の役割を明確に定義し、
判断をドキュメントとして残す仕組み**が必要となった。

---

## Decision（決定事項）

以下の方針を正式決定とする。

1. **開発環境は VS Code を主軸とする**
2. **AI は拡張機能単位で切り替え、役割固定で使用する**
3. **AI の指示内容はプロンプトとしてリポジトリに管理する**
4. **仕様・判断・運用ルールは会話ではなく Markdown で残す**
5. **工程ごとに専用プロンプトを定義し、AI の越権行為を防止する**

---

## Tooling Strategy（ツール構成）

### 開発エディタ

- **VS Code**
  - 拡張機能により AI を明示的に切り替え可能
  - プロジェクト単位で設定・ルールを固定できる
  - Git との親和性が高く、履歴管理が容易

### 使用 AI と役割

| AI | 役割 | 主用途 |
|---|---|---|
| ChatGPT | 編集長 / 司令塔 | 仕様策定、設計統合、README/ADR 作成 |
| Codex | 実装担当 | 機能実装、テスト実装 |
| Gemini | 監査担当 | 仕様監査、カバレッジ分析 |
| Claude | 構造改修担当 | 複数ファイル横断の大規模整理 |

---

## Prompt Architecture（プロンプト体系）

プロンプトは工程別に分離し、番号で意味と順序を表す。

```
docs/prompts/
  dev/
    01_Implement.prompt.md
    02_Refactor.prompt.md
    03_Test.prompt.md
  audit/
    11_SpecAudit.prompt.md
    12_CoverageMatrix.prompt.md
  editor/
    21_Integrate.prompt.md
  refactor/
    22_LargeRefactor.prompt.md
```

- 番号は工程順・重みを示す
- 同一番号は同一フェーズのみで使用する

---

## Consequences（結果・効果）

### 良い点

- AI の役割が明確になり、事故が減少する
- 開発手順が再現可能になる
- 判断履歴が Git に残り、説明責任を果たせる
- AI を「人員」として工程に組み込める

### トレードオフ

- 初期にドキュメント整備のコストがかかる
- 即席・即断の作業にはやや不向き

---

## Alternatives Considered（検討した代替案）

- Cursor など AI 統合 IDE を主軸にする案
  - 実装速度は高いが、判断の正本が曖昧になりやすいため採用しない

- 単一 AI に全工程を任せる案
  - 品質・説明責任・再現性に課題があるため不採用

---

## Notes（補足）

- 本 ADR は、AI ツールや運用方針に変更が生じた場合に更新する
- 例外運用を行う場合は、新たな ADR を追加する

---

## Revision History

- 2026-02-03: 初版作成

